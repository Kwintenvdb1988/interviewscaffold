# Development Dockerfile with hot reloading

FROM maven:3.9.6-eclipse-temurin-17

# Install Node.js and npm
RUN curl -fsSL https://deb.nodesource.com/setup_18.x | bash - && \
    apt-get install -y nodejs

# Set working directory
WORKDIR /app

# Copy Maven files
COPY pom.xml ./
COPY mvnw ./
COPY mvnw.cmd ./

# Copy frontend package files
COPY frontend/package*.json ./frontend/

# Install frontend dependencies
WORKDIR /app/frontend
RUN npm install

# Copy frontend source
COPY frontend/ ./

# Build frontend
RUN npm run build:spring

# Switch back to app directory
WORKDIR /app

# Copy source code
COPY src/ ./src/

# Expose port
EXPOSE 8080

# Start the application with hot reloading
CMD ["./mvnw", "spring-boot:run"] 